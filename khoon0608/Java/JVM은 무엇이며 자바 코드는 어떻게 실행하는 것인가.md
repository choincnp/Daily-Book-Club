# JVM은 무엇이며 자바 코드는 어떻게 실행하는 것인가

스터디 링크: https://github.com/whiteship/live-study/issues/1
완료: No

**🔗 참고자료**

- 이것은 자바다 강의([https://youtu.be/Zt4Ze4jNDUE](https://youtu.be/Zt4Ze4jNDUE))
- ChatGPT
- 위키 백과 ([https://ko.m.wikipedia.org/wiki](https://ko.m.wikipedia.org/wiki/JIT_%EC%BB%B4%ED%8C%8C%EC%9D%BC))
- ITWORLD([https://www.itworld.co.kr/news](https://www.itworld.co.kr/news/110837))
- IBM([https://www.ibm.com/docs/ko/sdk-java-technology/8?topic=reference-jit-compiler](https://www.ibm.com/docs/ko/sdk-java-technology/8?topic=reference-jit-compiler))

# JVM이란 무엇인가

자바 바이트코드를  어떤 운영체제나 플랫폼에서도 규격에 정의된 대로 동일하게 동작하게 하는 가상 머신

가상 운영체제를 생성하지 않아 런타임 환경 또는 프로세스 가상 머신이라고 정의하기도 함

### 2가지 기본 기능

- 플랫폼, 운영 체제에 무관하게 실행될 수 있게 하는 것
- 프로그램 메모리를 관리하고 최적화하는 것

자바 애플리케이션을 실행하기 위해 자바 클래스 로더와 실행 엔진에 의존함

### 자바 클래스 로더

클래스를 메모리에 로드라고 실행을 위해 사용할 수 있게 만드는 JVM의 일부

클래스 로딩을 효율적으로 수행하기 위해 지연 로딩 (Lazy-loading)과 캐싱(Caching) 같은 기법을 활용

### 실행 엔진

JVM이 각 클래스에 있는 코드를 실행할 때 쓰는 요소

코드 실행에는 시스템 리소스에 대한 액세스 관리가 관련되어 있는데 실행 엔진은 프로그램 실행과 운영체제 가운데에서 리소스를 공급한다. 

# 컴파일, 실행 하는 방법

1. 자바와 자바 개발 키트 (JDK)를 운영체제에 알맞게 다운 받는다.
2. 자바 소스 파일을 생성한다.
3. 프롬프트를 열어 소스 파일이 있는 디렉토리로 이동한다.
4. javac [소스 파일].java를 입력해서 소스 파일을 컴파일하여 바이트 코드 파일( [소스 파일].class )을 생성.
5. 에러가 없다면 java [소스 파일]을 입력해서 실행시킨다.

# 바이트코드란 무엇인가

JVM이 실행되는 명령어의 형태

자바 소스 파일을 컴파일하여 생성되는 중간 코드

### 바이트코드 명령어

각 명령어의 분류

- 읽고 쓰기 (e.g. aload_0, istore)
- 산술논리 연산 (e.g. ladd, fcmpl)
- 타입변환 (e.g. i2b, d2i)
- 객체생성 및 조작 (new, putfield)
- 오퍼랜드 스택 관리 (e.g. swap, dup2)
- 제어 (e.g. ifeq, goto)
- 함수 호출 및 반환 (e.g. invokespecial, areturn)

# JIT 컴파일러란 무엇이며 어떻게 동작하는지

Just-In-Time 컴파일러

런타임 시 바이트 코드를 원시 시스템 코드로 컴파일하여 Java 애플리케이션의 성능을 향상시키는 러타임 환경의 컴포넌트

런타임 시 JVM은 클래스 파일을 로드하고 해석하는데 이때 추가 프로세서 및 메모리 사용은 자바 애플리케이션이 원시 애플리케이션보다 낮은 속도로 수행되기 때문이고 JIT 컴파일러는 바이트 코드를 원시 시스템 코드로 컴파일하여 Java 프로그램의 성능을 향상시키는데 도움이 됨

### 동작

 JVM은 각 메소드에 대해 사전 정의된 컴파일 임계값에서 시작되고 해당 메소드가 호출될 때마다 감소되는 호출 개수를 유지보수함

호출 개수가 0에 도달하면 해당메소드에 대한 JIT 컴파일이 트리거됨

따라서 자주 사용되는 메소드는 JVM이 시작된 직후 컴파일되며 자주 사용되지 않는 메소드는 나중에 컴파일되거나 되지 않음

JIT 컴파일 임계값은 JVM을 빠르게 시작하고 JVM의 성능을 향상시키는데 도움이 됨

# JVM의 구성

- 자바 인터프리터
자바 컴파일러에 의해 변환된 바이트 코드를 읽고 기계어로 해석해 주는 역할
성능 이슈로 JIT 컴파일러가 추가되어 병행해서 사용함
- 클래스 로더
필요한 순간에 해당 클래스 파일을 찾아 메모리에 로딩해주는 역할
- JIT 컴파일러
- 가비지 컬렉터
메모리를 자동 관리해주는 역할
개발자가 메모리에 신경쓰지않게 하여 비즈니스 로직에 집중할 수 있게 해줌

# JDK와 JRE의 차이

### JDK: 자바 개발 키트

JVM + 라이브러리 API, 컴파일러 등의 개발도구가 포함

### JRE: 자바 런타임 환경

JVM +  라이브러리 API만 포함되어 있어 자바 프로그램을 실행시키고자 한다면 JRE만 설치하면 됨

⇒ JDK = JRE (JVM +  표준 클래스 라이브러리) + 기타 개발도구

# JVM 구성 요소